
pnguyen@phact:~/code/one_off_code/sentiment_analysis_twitter$ python3 models.py
Initializing classifier...
Normalizing texts: 100% 25000/25000 [00:04<00:00, 5709.92it/s]
Loading labels: 100% 25000/25000 [00:00<00:00, 901186.88it/s]
Determining unique vocabulary: 100% 6020196/6020196 [00:01<00:00, 3524325.24it/s]
models.py:212: UserWarning: Got an unexpectedly large input text size of 2514
  warnings.warn("Got an unexpectedly large input text size of {max_text_word_length}".format(max_text_word_length=unpadded_max_text_word_length))
Max Sequence Length: 256
Starting training...

Training for epoch 0
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.25it/s]

    Mean Validation Loss: 0.011090
    Incorrect Results: 1252 / 2500

Mean training loss: 0.69283156: 100% 352/352 [54:36<00:00,  9.31s/it]
Training for epoch 0.
Total loss for epoch 0: 243.87671011686325
Mean loss for epoch 0: 0.6928315628319979


Training for epoch 1
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.25it/s]

    Mean Validation Loss: 0.011088
    Incorrect Results: 1208 / 2500

Mean training loss: 0.67635615: 100% 352/352 [14:52<00:00,  2.54s/it]
Training for epoch 1.
Total loss for epoch 1: 238.07736593484879
Mean loss for epoch 1: 0.6763561532240022


Training for epoch 2
Calculating validation statistics...: 100% 40/40 [00:16<00:00,  2.48it/s]

    Mean Validation Loss: 0.010192
    Incorrect Results: 831 / 2500

Mean training loss: 0.57077764: 100% 352/352 [07:46<00:00,  1.33s/it]
Training for epoch 2.
Total loss for epoch 2: 200.91372793912888
Mean loss for epoch 2: 0.570777636190707


Training for epoch 3
Calculating validation statistics...: 100% 40/40 [00:13<00:00,  3.04it/s]

    Mean Validation Loss: 0.009140
    Incorrect Results: 627 / 2500

Mean training loss: 0.46487147: 100% 352/352 [08:38<00:00,  1.47s/it]
Training for epoch 3.
Total loss for epoch 3: 163.6347577869892
Mean loss for epoch 3: 0.4648714709857648


Training for epoch 4
Calculating validation statistics...: 100% 40/40 [00:14<00:00,  2.85it/s]

    Mean Validation Loss: 0.008492
    Incorrect Results: 576 / 2500

Mean training loss: 0.36817100: 100% 352/352 [08:53<00:00,  1.52s/it]
Training for epoch 4.
Total loss for epoch 4: 129.59619249403477
Mean loss for epoch 4: 0.36817100140350784


Training for epoch 5
Calculating validation statistics...: 100% 40/40 [00:20<00:00,  1.97it/s]

    Mean Validation Loss: 0.007937
    Incorrect Results: 450 / 2500

Mean training loss: 0.30376632: 100% 352/352 [09:49<00:00,  1.67s/it]
Training for epoch 5.
Total loss for epoch 5: 106.925745382905
Mean loss for epoch 5: 0.30376632211052557


Training for epoch 6
Calculating validation statistics...: 100% 40/40 [00:19<00:00,  2.07it/s]

    Mean Validation Loss: 0.008138
    Incorrect Results: 491 / 2500

Mean training loss: 0.23606694: 100% 352/352 [07:36<00:00,  1.30s/it]
Training for epoch 6.
Total loss for epoch 6: 83.09556180983782
Mean loss for epoch 6: 0.23606693695976652


Training for epoch 7
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.18it/s]

    Mean Validation Loss: 0.007444
    Incorrect Results: 405 / 2500

Mean training loss: 0.19066954: 100% 352/352 [07:55<00:00,  1.35s/it]
Training for epoch 7.
Total loss for epoch 7: 67.11567715927958
Mean loss for epoch 7: 0.190669537384317


Training for epoch 8
Calculating validation statistics...: 100% 40/40 [00:18<00:00,  2.20it/s]

    Mean Validation Loss: 0.007689
    Incorrect Results: 414 / 2500

Mean training loss: 0.15539098: 100% 352/352 [09:06<00:00,  1.55s/it]
Training for epoch 8.
Total loss for epoch 8: 54.697623919695616
Mean loss for epoch 8: 0.15539097704458982


Training for epoch 9
Calculating validation statistics...: 100% 40/40 [00:20<00:00,  1.95it/s]

    Mean Validation Loss: 0.008845
    Incorrect Results: 409 / 2500

Mean training loss: 0.12008278: 100% 352/352 [09:19<00:00,  1.59s/it]
Training for epoch 9.
Total loss for epoch 9: 42.26913941651583
Mean loss for epoch 9: 0.1200827824332836


Training for epoch 10
Calculating validation statistics...: 100% 40/40 [00:19<00:00,  2.00it/s]

    Mean Validation Loss: 0.009735
    Incorrect Results: 407 / 2500

Mean training loss: 0.09951679: 100% 352/352 [09:42<00:00,  1.65s/it]
Training for epoch 10.
Total loss for epoch 10: 35.02990918699652
Mean loss for epoch 10: 0.0995167874630583


Training for epoch 11
Calculating validation statistics...: 100% 40/40 [00:17<00:00,  2.34it/s]

    Mean Validation Loss: 0.009135
    Incorrect Results: 380 / 2500

Mean training loss: 0.07556405: 100% 352/352 [09:05<00:00,  1.55s/it]
Training for epoch 11.
Total loss for epoch 11: 26.598547188565135
Mean loss for epoch 11: 0.07556405451296913


Training for epoch 12
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.22it/s]

    Mean Validation Loss: 0.009757
    Incorrect Results: 408 / 2500

Mean training loss: 0.05730223: 100% 352/352 [07:19<00:00,  1.25s/it]
Training for epoch 12.
Total loss for epoch 12: 20.170386641751975
Mean loss for epoch 12: 0.05730223477770447


Training for epoch 13
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.22it/s]

    Mean Validation Loss: 0.010600
    Incorrect Results: 397 / 2500

Mean training loss: 0.04317222: 100% 352/352 [07:24<00:00,  1.26s/it]
Training for epoch 13.
Total loss for epoch 13: 15.19662253477145
Mean loss for epoch 13: 0.043172223110146166


Training for epoch 14
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.23it/s]

    Mean Validation Loss: 0.010342
    Incorrect Results: 370 / 2500

Mean training loss: 0.04008631: 100% 352/352 [07:23<00:00,  1.26s/it]
Training for epoch 14.
Total loss for epoch 14: 14.110380062018521
Mean loss for epoch 14: 0.040086306994370796


Training for epoch 15
Calculating validation statistics...: 100% 40/40 [00:13<00:00,  3.00it/s]

    Mean Validation Loss: 0.011057
    Incorrect Results: 370 / 2500

Mean training loss: 0.02853531: 100% 352/352 [07:23<00:00,  1.26s/it]
Training for epoch 15.
Total loss for epoch 15: 10.044429738103645
Mean loss for epoch 15: 0.028535311755976265


Training for epoch 16
Calculating validation statistics...: 100% 40/40 [00:20<00:00,  1.95it/s]

    Mean Validation Loss: 0.011903
    Incorrect Results: 374 / 2500

Mean training loss: 0.02128545: 100% 352/352 [09:11<00:00,  1.57s/it]
Training for epoch 16.
Total loss for epoch 16: 7.492478519416181
Mean loss for epoch 16: 0.021285450339250514


Training for epoch 17
Calculating validation statistics...: 100% 40/40 [00:17<00:00,  2.29it/s]

    Mean Validation Loss: 0.013372
    Incorrect Results: 364 / 2500

Mean training loss: 0.01620444: 100% 352/352 [08:48<00:00,  1.50s/it]
Training for epoch 17.
Total loss for epoch 17: 5.703964087617351
Mean loss for epoch 17: 0.01620444343073111


Training for epoch 18
Calculating validation statistics...: 100% 40/40 [00:18<00:00,  2.13it/s]

    Mean Validation Loss: 0.015051
    Incorrect Results: 373 / 2500

Mean training loss: 0.02408660: 100% 352/352 [08:29<00:00,  1.45s/it]
Training for epoch 18.
Total loss for epoch 18: 8.478483308412251
Mean loss for epoch 18: 0.02408660030798935


Training for epoch 19
Calculating validation statistics...: 100% 40/40 [00:15<00:00,  2.53it/s]

    Mean Validation Loss: 0.012315
    Incorrect Results: 393 / 2500

Mean training loss: 0.01526782: 100% 352/352 [07:08<00:00,  1.22s/it]
Training for epoch 19.
Total loss for epoch 19: 5.374274077639711
Mean loss for epoch 19: 0.015267824084203725


Training for epoch 20
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.32it/s]

    Mean Validation Loss: 0.016377
    Incorrect Results: 464 / 2500

Mean training loss: 0.01587152: 100% 352/352 [07:17<00:00,  1.24s/it]
Training for epoch 20.
Total loss for epoch 20: 5.586774688010337
Mean loss for epoch 20: 0.015871519000029366


Training for epoch 21
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.19it/s]

    Mean Validation Loss: 0.017333
    Incorrect Results: 381 / 2500

Mean training loss: 0.01567030: 100% 352/352 [07:01<00:00,  1.20s/it]
Training for epoch 21.
Total loss for epoch 21: 5.515946364554111
Mean loss for epoch 21: 0.015670302172028725


Training for epoch 22
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.32it/s]

    Mean Validation Loss: 0.018418
    Incorrect Results: 384 / 2500

Mean training loss: 0.01271869: 100% 352/352 [07:02<00:00,  1.20s/it]
Training for epoch 22.
Total loss for epoch 22: 4.476978453476477
Mean loss for epoch 22: 0.012718688788285444


Training for epoch 23
Calculating validation statistics...: 100% 40/40 [00:14<00:00,  2.77it/s]

    Mean Validation Loss: 0.017589
    Incorrect Results: 387 / 2500

Mean training loss: 0.00786286: 100% 352/352 [07:13<00:00,  1.23s/it]
Training for epoch 23.
Total loss for epoch 23: 2.767724960864143
Mean loss for epoch 23: 0.007862855002454953


Training for epoch 24
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.25it/s]

    Mean Validation Loss: 0.016811
    Incorrect Results: 373 / 2500

Mean training loss: 0.00779258: 100% 352/352 [06:57<00:00,  1.19s/it]
Training for epoch 24.
Total loss for epoch 24: 2.742987479614385
Mean loss for epoch 24: 0.0077925780670863205


Training for epoch 25
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.31it/s]

    Mean Validation Loss: 0.017698
    Incorrect Results: 360 / 2500

Mean training loss: 0.01239520: 100% 352/352 [07:12<00:00,  1.23s/it]
Training for epoch 25.
Total loss for epoch 25: 4.363109755693586
Mean loss for epoch 25: 0.01239519816958405


Training for epoch 26
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.24it/s]

    Mean Validation Loss: 0.013319
    Incorrect Results: 382 / 2500

Mean training loss: 0.00821416: 100% 352/352 [07:15<00:00,  1.24s/it]
Training for epoch 26.
Total loss for epoch 26: 2.8913839798588015
Mean loss for epoch 26: 0.008214159033689777


Training for epoch 27
Calculating validation statistics...: 100% 40/40 [00:12<00:00,  3.27it/s]

    Mean Validation Loss: 0.015172
    Incorrect Results: 369 / 2500

Mean training loss: 0.00387209:  56% 196/352 [04:04<03:14,  1.24s/it]  C-c C-cTraceback (most recent call last):
  File "models.py", line 381, in <module>
    main()
  File "models.py", line 376, in main
    classifier.train(NUMBER_OF_EPOCHS)
  File "models.py", line 272, in train
    self.train_one_iteration(inputs, labels)
  File "models.py", line 293, in train_one_iteration
    loss.backward()
  File "/home/pnguyen/.local/lib/python3.5/site-packages/torch/tensor.py", line 166, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/pnguyen/.local/lib/python3.5/site-packages/torch/autograd/__init__.py", line 99, in backward
    allow_unreachable=True)  # allow_unreachable flag
KeyboardInterrupt
Mean training loss: 0.00387209:  56% 196/352 [04:05<03:15,  1.25s/it]
pnguyen@phact:~/code/one_off_code/sentiment_analysis_twitter$ 
